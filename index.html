<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Campionato Arena</title>
<style>
body { font-family:'Segoe UI',sans-serif; background: linear-gradient(135deg,#0a2a43,#0f5132); color:#fff; margin:0; padding:0;}
header {text-align:center; padding:15px; background:linear-gradient(90deg,#008C45,#F4F5F0,#CD212A); color:#000; font-weight:bold; font-size:24px;}
main {padding:10px; max-width:480px; margin:auto;}
.tabs {display:flex; flex-wrap: wrap; border-bottom:2px solid #fff; margin-bottom:10px;}
.tab {flex:1 1 45%; text-align:center; padding:8px 5px; cursor:pointer; background:rgba(255,255,255,0.1); border-radius:10px 10px 0 0; margin:2px; font-size:14px;}
.tab.active {background:#ffc107; color:#000; font-weight:bold;}
.tabContent {display:none;}
.tabContent.active {display:block;}
.card {background:rgba(255,255,255,0.1); border-radius:12px; padding:15px; margin-bottom:15px; box-shadow:0 5px 15px rgba(0,0,0,0.3);}
input, select, button {width:100%; padding:8px; border-radius:8px; border:none; margin:4px 0; font-size:14px;}
button {background:#ffc107; cursor:pointer; font-weight:bold;}
ul {list-style:none; padding:0; font-size:14px;}
table {width:100%; border-collapse:collapse; margin-top:8px; font-size:12px;}
th, td {border:1px solid #fff; padding:4px; text-align:center;}
.highlight {background-color: rgba(255,255,0,0.3); font-weight:bold;}
footer {text-align:center; padding:10px; font-size:12px; opacity:0.7;}
.logoutBtn {margin-top:5px; background:#ff4d4d;}
.statBtn {width:30%; margin:2px auto; display:inline-block;}
</style>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
</head>
<body>
<header>ğŸ† Campionato Arena</header>
<main>

<!-- LOGIN -->
<div class="card" id="loginCard">
<h2>ğŸ” Accesso</h2>
<input id="loginNome" placeholder="Inserisci il tuo nome" />
<div id="passwordDiv" style="display:none;">
  <input id="loginPassword" type="password" placeholder="Password (solo admin)" />
</div>
<br>
<button id="btnLogin">Entra</button>
<p id="loginInfo" style="margin-top:8px;opacity:0.8"></p>
</div>

<!-- APP CONTENT -->
<div id="appContent" style="display:none">
<button class="logoutBtn" id="btnLogout">ğŸšª Logout</button>

<div class="tabs">
<div class="tab active" data-tab="squadreTab">ğŸ‘¥ Squadre</div>
<div class="tab" data-tab="classificaTab">ğŸ† Classifica</div>
<div class="tab" data-tab="statTab">âš½ Statistiche</div>
<div class="tab" data-tab="calendarioTab">ğŸ“… Calendario</div>
<div class="tab" data-tab="scoreTab">ğŸ“Š Mio Score</div>
<div class="tab" data-tab="backupTab">ğŸ’¾ Backup</div>
</div>

<!-- TABS CONTENT -->
<div id="squadreTab" class="tabContent active">
<h3>Gestione Squadre</h3>
<input id="newSquadra" placeholder="Nome squadra" />
<select id="newColore">
<option value="#ff0000">Rosso</option>
<option value="#00ff00">Verde</option>
<option value="#0000ff">Blu</option>
<option value="#ffff00">Giallo</option>
<option value="#ff00ff">Fucsia</option>
<option value="#00ffff">Ciano</option>
<option value="#ffa500">Arancione</option>
<option value="#800080">Viola</option>
<option value="#008080">Teal</option>
<option value="#000000">Nero</option>
</select>
<button id="btnAddSquadra">â• Aggiungi Squadra</button>

<h4>Aggiungi Giocatore a Squadra</h4>
<select id="selectSquadra"></select>
<input id="nomeGiocatore" placeholder="Nome giocatore" />
<select id="ruoloGiocatore">
  <option value="Calciatore">Calciatore</option>
  <option value="Capitano">Capitano</option>
  <option value="Portiere">Portiere</option>
</select>
<button id="btnAddGiocatore">â• Aggiungi Giocatore</button>

<div id="listaSquadre"></div>
</div>

<div id="classificaTab" class="tabContent"><h3>Classifica</h3><div id="tabellaClassifica"></div></div>
<div id="statTab" class="tabContent"><h3>Statistiche Generali</h3><div id="tabellaStats"></div></div>
<div id="calendarioTab" class="tabContent"><h3>Calendario</h3>
<div>
<button id="btnAddPartita">â• Aggiungi Partita</button>
<div id="listaCalendario"></div>
</div>
</div>
<div id="scoreTab" class="tabContent"><h3>Mio Score</h3><div id="tabellaMioScore"></div></div>
<div id="backupTab" class="tabContent"><h3>Backup Admin</h3><p>Solo per amministratori.</p></div>

</main>
<footer>Ideata da Vitlollo Â· Sviluppata con ChatGPT âš½ğŸ‡®ğŸ‡¹</footer>

<script>
// ---------------- FIREBASE -----------------
const firebaseConfig = {
  apiKey: "AIzaSyDZhOEHZcHELj_wy1gmCqX8-8zPQe0WcMk",
  authDomain: "campionato-arena-2026.firebaseapp.com",
  projectId: "campionato-arena-2026",
  storageBucket: "campionato-arena-2026.firebasestorage.app",
  messagingSenderId: "844668143316",
  appId: "1:844668143316:web:c72cb60c6e3513582f5d41"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// ---------------- LOGIN -----------------
let loggedUser='';
const admins={"Vitantonio":"giulia85","Fabrizio":"manetta26","Jacopo":"forzaroma1"};

const loginNome = document.getElementById('loginNome');
const loginPassword = document.getElementById('loginPassword');
const passwordDiv = document.getElementById('passwordDiv');

loginNome.addEventListener('input', ()=>{
  passwordDiv.style.display = admins[loginNome.value.trim()]?'block':'none';
});

document.querySelectorAll('.tab').forEach(tab=>tab.addEventListener('click',()=>{
  document.querySelectorAll('.tabContent').forEach(tc=>tc.classList.remove('active'));
  document.getElementById(tab.dataset.tab).classList.add('active');
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  tab.classList.add('active');
}));

document.getElementById('btnLogin').addEventListener('click', async ()=>{
  const nome = loginNome.value.trim();
  const password = loginPassword.value;
  const info = document.getElementById('loginInfo');
  if(!nome){ info.innerText='Inserisci un nome valido'; return; }
  if(admins[nome] && admins[nome]!==password){ info.innerText='Password errata!'; return; }
  info.innerText='';
  loggedUser = nome;
  document.getElementById('loginCard').style.display='none';
  document.getElementById('appContent').style.display='block';
  document.querySelector(`.tab[data-tab='backupTab']`).style.display=(admins[nome]? 'block':'none');
  loadSquadre();
  loadCalendario();
  loadStats();
  loadMioScore();
});

document.getElementById('btnLogout').addEventListener('click', ()=>{
  loggedUser='';
  document.getElementById('appContent').style.display='none';
  document.getElementById('loginCard').style.display='block';
  loginNome.value='';
  loginPassword.value='';
  passwordDiv.style.display='none';
});

// ---------------- GESTIONE SQUADRE -----------------
const selectSquadra = document.getElementById('selectSquadra');

document.getElementById('btnAddSquadra').addEventListener('click', async ()=>{
  const nome = document.getElementById('newSquadra').value.trim();
  const colore = document.getElementById('newColore').value;
  if(!nome){ alert('Inserisci nome squadra'); return; }
  const docRef = db.collection('squadre').doc(nome);
  await docRef.set({colore, giocatori:[]});
  document.getElementById('newSquadra').value='';
  loadSquadre();
});

document.getElementById('btnAddGiocatore').addEventListener('click', async ()=>{
  const squadra = selectSquadra.value;
  const nome = document.getElementById('nomeGiocatore').value.trim();
  const ruolo = document.getElementById('ruoloGiocatore').value;
  if(!nome){ alert('Inserisci nome giocatore'); return; }
  const squadraRef = db.collection('squadre').doc(squadra);
  const doc = await squadraRef.get();
  if(doc.exists){
    const data = doc.data();
    if(data.giocatori.find(g=>g.nome===nome)){ alert('Giocatore giÃ  esistente'); return; }
    data.giocatori.push({nome, ruolo, gol:0, assist:0, presenze:0, giallo:0, rosso:0});
    await squadraRef.update({giocatori:data.giocatori});
    document.getElementById('nomeGiocatore').value='';
    loadSquadre();
  }
});

function loadSquadre(){
  db.collection('squadre').onSnapshot(snapshot=>{
    selectSquadra.innerHTML='';
    const lista = document.getElementById('listaSquadre');
    lista.innerHTML='';
    snapshot.forEach(doc=>{
      const s = doc.data();
      selectSquadra.innerHTML += `<option value="${doc.id}">${doc.id}</option>`;
      lista.innerHTML += `<div style="border:1px solid #fff;margin:5px;padding:5px;background:${s.colore}">
        <b>${doc.id}</b><ul>${s.giocatori.map(g=>`<li>${g.nome} (${g.ruolo})</li>`).join('')}</ul></div>`;
    });
  });
}

// ---------------- CALENDARIO & TABELLINO -----------------
async function loadCalendario(){
  const lista = document.getElementById('listaCalendario');
  lista.innerHTML='';
  db.collection('partite').onSnapshot(snapshot=>{
    lista.innerHTML='';
    snapshot.forEach(doc=>{
      const p = doc.data();
      const div = document.createElement('div');
      div.style.border='1px solid #fff';
      div.style.margin='5px';
      div.style.padding='5px';
      div.innerHTML = `<b>${p.squadra1} vs ${p.squadra2} (${p.data||''})</b><br>
        Risultato: ${p.risultato||'-'}<br>
        Marcatori: ${p.marcatori||'-'}<br>
        Assist: ${p.assist||'-'}<br>
        Cartellini G/R: ${p.giallo||0}/${p.rosso||0}<br>
        Presenze: ${p.presenze||'-'}`;
      lista.appendChild(div);
    });
  });
}

// ---------------- STATISTICHE -----------------
async function loadStats(){
  const tabStats = document.getElementById('tabellaStats');
  tabStats.innerHTML="<p>âš½ Statistiche live da calendario e tabellino.</p>";
}

// ---------------- MIO SCORE -----------------
function loadMioScore(){
  const tabScore = document.getElementById('tabellaMioScore');
  tabScore.innerHTML=`<p>ğŸ“Š Qui vedrai le tue statistiche, ${loggedUser}</p>`;
}
</script>
</body>
</html>
