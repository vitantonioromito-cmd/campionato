<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Campionato Arena</title>
<link rel="manifest" href="manifest.json">
<style>
body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg,#0a2a43,#0f5132); color:#fff; margin:0; padding:0;}
header {text-align:center; padding:20px; background:linear-gradient(90deg,#008C45,#F4F5F0,#CD212A); color:#000; font-weight:bold; font-size:26px;}
main {padding:20px; max-width:900px; margin:auto;}
.tabs {display:flex; border-bottom:2px solid #fff; margin-bottom:20px;}
.tab {padding:10px 20px; cursor:pointer; background:rgba(255,255,255,0.1); border-radius:10px 10px 0 0; margin-right:5px;}
.tab.active {background:#ffc107; color:#000; font-weight:bold;}
.tabContent {display:none;}
.tabContent.active {display:block;}
.card {background:rgba(255,255,255,0.1); border-radius:16px; padding:20px; margin-bottom:20px; box-shadow:0 10px 30px rgba(0,0,0,0.3);}
input, select, button {padding:10px; border-radius:10px; border:none; margin:5px 0; font-size:16px;}
button {background:#ffc107; cursor:pointer; font-weight:bold;}
ul {list-style:none; padding:0;}
table {width:100%; border-collapse:collapse; margin-top:10px;}
th, td {border:1px solid #fff; padding:5px; text-align:center;}
.highlight {background-color: rgba(255,255,0,0.3); font-weight:bold;}
footer {text-align:center; padding:15px; font-size:14px; opacity:0.7;}
</style>
<!-- Firebase -->
<script type="module">
  // Import Firebase SDK
  import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js';
  import { getFirestore, collection, doc, setDoc, getDocs, updateDoc } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js';

  const firebaseConfig = {
    apiKey: "INSERISCI_LA_TUA_API_KEY",
    authDomain: "campionato-arena-2026.firebaseapp.com",
    projectId: "campionato-arena-2026",
    storageBucket: "campionato-arena-2026.appspot.com",
    messagingSenderId: "844668143316",
    appId: "1:844668143316:web:c72cb60c6e3513582f5d41"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
</script>
</head>
<body>
<header>ğŸ† Campionato Arena</header>
<main>
<div class="card" id="loginCard">
<h2>ğŸ” Accesso</h2>
<input id="loginNome" placeholder="Inserisci il tuo nome" />
<input id="loginPassword" type="password" placeholder="Password (solo admin)" />
<br>
<button id="btnLogin">Entra</button>
<p id="loginInfo" style="margin-top:10px;opacity:0.8"></p>
</div>

<div id="appContent" style="display:none">
<div class="tabs">
<div class="tab active" onclick="showTab('squadreTab')">ğŸ‘¥ Squadre</div>
<div class="tab" onclick="showTab('classificaTab')">ğŸ† Classifica</div>
<div class="tab" onclick="showTab('statTab')">âš½ Marcatori & Assist</div>
<div class="tab" onclick="showTab('calendarioTab')">ğŸ“… Calendario</div>
<div class="tab" onclick="showTab('scoreTab')">ğŸ“Š Mio Score</div>
<div class="tab" onclick="showTab('backupTab')">ğŸ’¾ Backup</div>
</div>

<div id="squadreTab" class="tabContent active"></div>
<div id="classificaTab" class="tabContent"></div>
<div id="statTab" class="tabContent"></div>
<div id="calendarioTab" class="tabContent"></div>
<div id="scoreTab" class="tabContent"></div>
<div id="backupTab" class="tabContent"></div>
</main>
<footer>Ideata da Vitlollo Â· Sviluppata con ChatGPT âš½ğŸ‡®ğŸ‡¹</footer>

<script type="module">
import { collection, doc, setDoc, getDocs, updateDoc } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js';

let loggedUser = '';
const admins = {"Vitantonio":"giulia85","Fabrizio":"manetta26","Jacopo":"forzaroma1"};

function showTab(id){
  document.querySelectorAll('.tabContent').forEach(tc=>tc.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  document.querySelector(`.tab[onclick*='${id}']`).classList.add('active');
}

document.getElementById('btnLogin').addEventListener('click', async function(){
  const nome = document.getElementById('loginNome').value.trim();
  const password = document.getElementById('loginPassword').value;
  const info = document.getElementById('loginInfo');
  if(!nome){ info.innerText='Inserisci un nome valido'; return; }
  const isAdmin = admins[nome] && admins[nome]===password;
  info.innerText='';
  document.getElementById('loginCard').style.display='none';
  document.getElementById('appContent').style.display='block';
  loggedUser = nome;
  await mostraMioScore();
});

async function mostraMioScore(){
  const container = document.getElementById('scoreTab');
  container.innerHTML='';
  // Leggere dati da Firestore per il giocatore loggato
  const giocatoriCol = collection(db, 'giocatori');
  const snapshot = await getDocs(giocatoriCol);
  let trovato = false;
  snapshot.forEach(doc => {
    const g = doc.data();
    if(g.nome.toLowerCase() === loggedUser.toLowerCase()){
      trovato = true;
      container.innerHTML = `<h2>ğŸ“Š Statistiche di ${g.nome}</h2>
        <ul>
          <li>Ruolo: ${g.ruolo}</li>
          <li>Presenze: ${g.presenze || 0}</li>
          <li>Gol: ${g.gol || 0}</li>
          <li>Assist: ${g.assist || 0}</li>
          <li>Cartellini Gialli: ${g.giallo || 0}</li>
          <li>Cartellini Rossi: ${g.rosso || 0}</li>
        </ul>`;
    }
  });
  if(!trovato) container.innerHTML='<p>âš ï¸ Nessuna statistica disponibile.</p>';
}

// Service Worker registration per PWA
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('service-worker.js').then(()=>console.log('Service Worker registrato')); 
}
</script>
</body>
</html>